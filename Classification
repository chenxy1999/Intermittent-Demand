for (i in 1:dim(x)[1]){
  alpha=0.2;demand=t(as.vector(na.omit(x[i,])));
  flag=seq(0,0,length.out=dim(x)[1])
  kurtosis(demand)
  mean(demand)
  if ((mean(demand)<10) & (kurtosis(demand[,1])>3)){
    y=as.vector(quantile(demand)[4])
   demand[which(demand<=(quantile(demand)[4]+1.5*IQR(demand)))]=0;
   z=mean(demand[which(demand!=0)])
   p=mean((1-alpha)^diff(which(demand!=0)))
   
   
   if ((z*p)<(y+1.5*IQR(demand))) {
      flag[i]=1
   } 
  }
}
